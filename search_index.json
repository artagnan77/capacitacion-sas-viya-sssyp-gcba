[
["index.html", "Capacitacion SAS Viya para GCBA Preface", " Capacitacion SAS Viya para GCBA Sergio Lemme 2019-08-08 Preface This is the very first part of the book. https://github.com/ "],
["introduction.html", "Capítulo 1 Introduction", " Capítulo 1 Introduction This is the first real chapter. "],
["subir-nuestros-datos-a-sas-viya.html", "Capítulo 2 Subir nuestros datos a SAS Viya 2.1 Subir un archivo excel 2.2 Subir un archivo csv", " Capítulo 2 Subir nuestros datos a SAS Viya Como vimos anteriormente, la plataforma de BI nos permite acceder a una base de datos integrada de muchas y variadas fuentes de datos. Los datos de las diferentes fuentes se encuentran integrados en un solo modelo de datos, lo que permite la explotación integral de la información. Una de las fuentes principales del Datawarehouse que mantenemos en la Subsecretaria es la base de datos del ecosistema SADE. Un usuario de self-service podrá acceder a las tablas que este autorizado en función de su sector/rol dentro de la organización. Pero a veces el usuario necesita trabajar con otro set de datos, proveniente otro sector o bajado desde otra fuenta de datos. En estos casos puede subir su propio set de datos, dede un archivo CSV o una planilla excel y luego no sólo trabajar con estos datos sino también en caso de aplicar, combinarlos con tablas ya disponibles en la plataforma. 2.1 Subir un archivo excel Lo primero que debemos hacer antes de subir una planilla excel es verificar que sea lo más limpia posible para evitar errores, la planilla debe contener los datos en forma de tabla, con sus columnas y registros, sin filas vacías y con el menor formato posible. El archivo elegido en nuestro caso contiene una tabla con 3 columnas: EXPEDIENTE_CALC CODIGO_EXTRACTO ESTADO_EXP Figure 2.1: Archivo excel a subir Podría tratarse de un archivo provisto por otro sector requiriendo cierta información para los expedientes incluídos en el mismo. O bien una lista de expedientes que necesitamos cotejar versus los datos de la base de Expediente Electrónico de SADE. 2.1.1 Nuestra propia tabla CAS Los pasos a seguir para construir nuestra propia tabla CAS a partir del archivo serían los siguientes: Vamos a la sección “Gestionar Datos” Hacemos click en el “Menú de Aplicaciones”: Figure 2.2: Menu de aplicaciones Elegimos la opción “Gestionar Datos”: Figure 2.3: Opción del menú Gestionar Datos En esta sección podemos ver todas las tablas CAS disponibles que tenemos. Para subir nuesro archivo y construir nuestra propia tabla CAS debemos hacer click en Importar: Figure 2.4: Importar Seleccionamos “Archivo local”: Figure 2.5: Subir archivo local Ahora se nos abrirá el “wizard” de windows para que naveguemos por nuestras carpetas y seleccionemos el archivo. Una vez seleccionado, le damos al botón de “Abrir” y se abrirá la siguiente pantalla para ultimar los detalles de nuestra importación: Figure 2.6: Subir archivo local Por último hacemos click en “Importar elemento”. Si todo esta bien, el sistema arrojará un mensaje indicando que el proceso terminó correctamente. Asimismo, si ahora vamos a ver las tablas disponibles, deberíamos encontrar nuestra tabla cargada. 2.2 Subir un archivo csv Google nos dirá: “Los archivos CSV son un tipo de documento en formato abierto sencillo para representar datos en forma de tabla, en las que las columnas se separan por comas y las filas por saltos de línea.” Si navegamos por “BA Data” https://data.buenosaires.gob.ar/ u otro sitio de intercambio de información, encontraremos que los set de datos disponibles en general se presentan en este formato. Seguramente tengamos menos problemas al operar con archivos de este tipo. 2.2.1 Pasos para subir un archivo CSV Repetimos todos los pasos que vimos al subir un excel hasta el punto 5. La pantalla a la que llegamos en este caso, presenta algunas opciones que debemos considerar, dependiendo de como este armardo nuestro archivo CSV. Delimitador En nuestro archivo de ejemplo, el delimitador de columnas es “;”, por lo tanto debemos modificar el valor por defecto “;”: Figure 2.7: Subir archivo local Figure 2.8: Subir archivo local También podemos indicar si la primera fila contiene o no los nombres de las columnas. Una vez configuradas todas las opciones en base al archivo que vamos a subir, hacemos click en “Importar elemento”. Y si todo salió bien, llegamos al final del proceso, con un mensaje que indica que todo salió bien: Figure 2.9: Subir archivo local 2.2.2 Posibles errores Si obtenemos un error feo, como el siguiente: Figure 2.10: Subir archivo local Tenemos un problema de encoding en el archivo, esto pasa cuando el archivo se guardo con un juego de caracteres diferente al que le indicamos a SAS al momento de subir el archivo. Un formato muy común y el que vamos a usar es “UTF-8” este cambio lo podemos hacer desde un editor de texto, como “Notepad++” Figure 2.11: Subir archivo local "],
["union-de-fuentes-de-datos.html", "Capítulo 3 Union de fuentes de datos 3.1 Cómo hacer una union de tablas 3.2 Guardar reporte 3.3 Nueva union de datos", " Capítulo 3 Union de fuentes de datos Hay muchos supuestos o situaciones en los que podemos necesitar hacer una combinación de diferentes fuentes de datos. Incluso cuando hablamos de Datawarehouse o BI, siempre en algún momento haremos referencia a integrar diferents fuentes de datos. En este capítulo, haciendo uso de las tablas que subimos en el capítulo anterior, vamos a practicar los famosos “JOINS” o uniones de datos. En general vamos a tener la mayoría de las tablas que necesitamos disponibles en el Datawarehouse, ya que esta tarea de hacer las “uniones” nos viene ya resuelta por el equipo de BI. Pero no siempre es así. Supongamos que un sector nos pasa un listado de expedientes con algun problema o situación particular y necesitamos obtener más datos asociados a ese listado de expedientes o bien combinar este listado con datos actualizados de SADE, que sabemos que tenemos disponible en la plataforma. Supongamos que ese listado fue el primer excel que subimos en el capítulo anterior: “CURSO_BI_GCBA_EXPEDIENTES” 3.1 Cómo hacer una union de tablas Una forma de hacer una union de fuentes de datos en SAS Viya es dentro de un reporte. Esta es la opción que veremos en la práctica. Iniciamos un nuevo reporte usando la opción del menú: “Explorar y visualizar datos” Figure 2.1: Explorar y visualizar datos Figure 2.2: Nuevo reporte Desde el panel de datos, hacemos click en “Seleccione para añadir fuente de datos”. Otra opción es hacer click en el icono de la derecha, “Acciones” y seleccionar “Añadir fuente de datos” En la siguiente ventana “Abrir fuente de datos” buscamos nuestra tabla, para ello basta con escribir las primeras letras para filtrar el listado de tablas disponibles hasta que podamos encontrar la tabla deseada: Figure 2.3: Selección de tabla Seleccionamos nuestra tabla, “CURSO_BI_GCBA_EXPEDIENTES” y presionamos “Aceptar” Volvemos al icono que nos abre las opciones de datos y elegimos en este caso “Nueva union de fuentes de datos…” Figure 2.4: Nueva union de fuentes de datos En la siguiene pantalla, debemos: Elegir la segunda tabla en “Fuente de datos 2” En este caso vamos a elegir la segunda tabla que subimos en el capítulo anterior que contiene datos de domicilios asociados a los expedientes. Asignar un nombre a la nueva tabla resultado Figure 2.5: Segunda tabla Elegir el tipo de union Figure 2.6: Tipo de union En este caso elegiremos la opción “Union izquierda” ya que no queremos perder datos de la tabla 1, que es la que debemos analizar, es la tabla que nos pasó el usuario para verificar. Seleccionar las columnas que deseamos incluir en la union Figure 2.7: Selección de columnas Si todo salió bien, deberíamos ver nuestra tabla resultando en la lista de fuentes de datos del reporte. 3.2 Guardar reporte Siempre es sano a medida que avanzamos ir guardando los cambios. Guardamos el reporte en nuestra carpeta personal “MyFolder” Figure 2.8: Guardar reporte 3.3 Nueva union de datos Para reforza este punto y además sumar otras columas a nuestra tabla, vamos a realizar una nueva uniÓn, utilizando como segunda fuente de datos la tabla “DIM_EXPEDIENTE_ELECTRONICO”. Esta tabla tiene todos los expedientes de SADE y datos principales asociados a estos, como ser el estado actualizado, la fecha de caratulación, el usuario, la repartición, etc. Como mínimo seleccionamos estas columnas para la práctica: Figure 2.9: Selección de columnas Y por último, nuevamente elegimos “Union izquierda”, porque queremos mantener todos los registros de la primera tabla. Figure 2.10: Selección de columnas Para esta nueva union usaremos el nombre “CURSO_BI_EXPEDIENTES” Si todo salió bien deberíamos ver agregada la nueva fuente de datos al reporte. Genial, explotaremos esta tabla en los capítulos siguientes! "],
["nuestro-primer-reporte.html", "Capítulo 4 Nuestro primer reporte 4.1 Objeto “Tabla de lista” 4.2 Filtros fijos sobre el objeto 4.3 Filtros sobre la fuente de datos 4.4 Filtros dinámicos 4.5 Ejercicio de ejemplo con comparación de datos 4.6 Acciones automáticas en todos los objetos 4.7 Contenedores", " Capítulo 4 Nuestro primer reporte Ahora usando la tabla resultante del capítulo anterior, vamos a diseñar nuestro primer reporte. El objetivo de este capítulo es aprender a realizar un reporte sencillo, para visualizar los datos de la tabla y agregar filtros, tanto fijos como dinámicos. 4.1 Objeto “Tabla de lista” En el panel de objetos a nuestra izquiera, vamos a seleccionar Tablas –&gt; Tabla de lista y arrastramos hacia el area de trabajo de la Página 1. Figure 2.1: Tabla de lista Tenemos dos formas de agregar columnas, Desde el panel general de datos, seleccionando los elementos y arrastrandolos hasta posicionarlos sobre la tabla, Teniendo seleccionado la tabla, desde el panel “Roles de datos”, eligiendo la opción Columnas, Añadir Nótese que hay un asterisco rojo que acompaña la sección “Columnas” eso indica que es obligatorio agregar al menos una columna para que el objeto, en este caso una tabla, se pueda construir. Figure 2.2: Tabla de lista Seleccionamos las columnas que deseamos visualizar en la tabla y hacemos click en “Aceptar” Figure 2.3: Tabla de lista Si todo salió bien, deberíamos estar viendo la tabla con los datos que elegimos. Es importante aclarar que el objeto tabla de lista tiene un límite de registros que se pueden visualizar, en general ese límite es de 40.000 filas. 4.2 Filtros fijos sobre el objeto Todos los objetos aceptan este tipo de filtro sobre los datos. Supongamos que queremos visualizar todos los expedientes cuyo “ESTADO_EXP” -estado actualizado del expediente- sea distinto a “Guarda Temporal”: * Siempre manteniendo el objeto seleccionado, en este caso nuestra tabla, seleccionamos la sección “filtros” del panel de la derecha. Figure 2.4: Tabla de lista Hacemos click en “Nuevo filtro” Seleccionamos el elemento de datos sobre el que queremos aplicar el filtro, en nuestro caso “ESTADO_EXP”. Destildamos los valores a descartar, “Guarda Temporal” y cualquier otro estado que queramos descartar. 4.3 Filtros sobre la fuente de datos Si queremos aplicar un filtro que afecte a todo el reporte, conviene utilizar esta opción. Por ejemplo si quisieramos descartar en todo el reporte los expedientes en “ARCHIVO TEMPORAL”. Vamos al panel de datos de la izquierda y seleccionamos la opción “Aplicar filtro a la fuente de datos…” Figure 2.5: Tabla de lista Llegamos a una pantalla un poco más avanzada para la construcción de filtros. Buscamos el elemento de datos sobre el que vamos a aplicar el filtro, en nuestro caso nuevamente “ESTADO_EXP” Arrastramos el elemento hacia el panel y lo soltamos en el cuadro “condición” Ahora subimos y elegimos la solapa de “Operadores” Elegimos dentro del grupo “Comparación” el operador distinto “&lt;&gt;” En “cadena” escribimos el valor que queremos descartar, por ejemplo “ARCHIVO TEMPORAL” Por último hacemos click en “ACEPTAR” Si todo funcionó como esperábamos la tabla no nos debería estar mostrando expedientes en ESTADO_EXP = “ARCHIVO TEMPORAL” 4.4 Filtros dinámicos Ahora vamos a sumar al reporte algunos controles simples para interactuar con la tabla en forma de filtros. El filtro más comun que existe en todo tablero o reporte es el filtro de fechas y sino esta en modo de filtro, seguramente tendremos un gráfico que muestra alguna evolución temporal de alguna medida. 4.4.1 Barra deslizante o slider Supongamos en nuestro caso que queremos agregar un filtro dinámico utilizando la fecha de creación (fecha de caratulación del expediente): * Vamos al panel de objetos y buscamos dentro del grupo “Controles” la “Barra deslizante”. Este control es muy útil para usar en fechas. * Arrastramos el objeto al area de trabajo intentando que nos quede arriba de la tabla. * En el panel de roles de datos, seleccionamos “FECHA DE CREACIÓN” * Por último, para que el control actúe como filtro sobre la tabla, manteniendo seleccionado el objeto, vamos a la sección “Acciones” del panel de la derecha. * Elegimos la tabla de lista, dentro de “Enlaces de objeto” Figure 2.6: Tabla de lista Ahora, si modificamos los valores de la barra deslizante, la tabla se debería actualizar, filtrando los datos en base al rango de fechas establecido. 4.4.2 Lista o lista desplegale Supongamos ahora que queremos incluir un filtro para seleccionar una o varias tratas. Para ello podemos usar los controles lista o lista desplegable. El primero nos permitirá elegir varios valores, la lista desplegable en cambio, sólo uno. Nuevamente nos dirigimos al panel de objetos, y dentro del grupo de “Controles” seleccionamos y arrastramos hacia el reporte, la “Lista” o “Lista desplegable”. En este caso elegiremos “Lista”, ya que queremos poder seleccionar varias tratas. *Tratamos de ubicar el objeto a la izquierda de nuestra tabla: Figure 2.7: Tabla de lista En el panel de roles de datos, seleccionamos “CODIGO_EXTRACTO” Luego, no debemos olvidar generar “la interacción” desde la sección “Acciones” del panel de la derecha al igual que el filtro anterior. Ahora si elegimos alguna trata, deberíamos ver como se actualiza la tabla. 4.5 Ejercicio de ejemplo con comparación de datos Si llegamos con el tiempo, podemos hacer un ejercicio para visualizar diferencias entre “ESTADO” y “ESTADO_EXP” 4.6 Acciones automáticas en todos los objetos Lo veremos en otro capítulo 4.7 Contenedores Lo veremos en otro capítulo "],
["nuestro-segundo-reporte.html", "Capítulo 5 Nuestro segundo reporte 5.1 Categorías vs. Medidas 5.2 Configuración inicial de los elementos de datos 5.3 Elementos calculados 5.4 Gráfico de barras 5.5 Controles de filtros 5.6 Acciones, hacer interactuar gráficos y filtros entre sí", " Capítulo 5 Nuestro segundo reporte Ahora vamos a construir un segundo reporte con algnos gráficos, elementos calculados y controles de filtros básicos. Siempre tratando de priorizar los conocimientos más útiles pensando en reportes sencillos para visualizar y controlar datos. Iniciamos un nuevo reporte y seleccionamos en este caso la tabla “CURSO_BI_GCBA_PLANES_PSOC”. Cada registro de esta tabla representa un beneficio. Cada beneficio corresponde a una persona, esta persona es el beneficiario y en la tabla tenemos tipo y numero de documento como datos identificatorios del mismo. Nota importante: La tabla CURSO_BI_GCBA_PLANES_PSOC esta basada en el modelo de datos de PSOC pero no refrleja en ningun caso datos reales. 5.1 Categorías vs. Medidas Los elementos de datos de nuestras tablas son clasificados como categorías o medidas, como podemos ver en la lista de elementos de nuestra fuente de datos. Medidas: Una medida es todo aquello que tiene sentido sumar, promediar u operar con alguna función matemática o estadística. Estan asociadas a las métricas que podemos obtener o indicadores a calcular. Sirven para responder las preguntas referidas a cantidades o importes. Por ejemplo: las ventas totales, los costos, los pagos. En nuestro ámbito, el monto asociado a los pagos, la cantidad de integrantes en un hogar, el tiempo de demora en la resolución de un trámite. Categorías: Estos datos estan asociados a las dimensiones, entidades o características que nos permiten identificar con quién, cuándo o dónde se genera una operación o transacción. Por ejemplo el número de documento, el código de trata, una repartición o usuario. 5.2 Configuración inicial de los elementos de datos Al añadir una fuenta de datos al reporte, SAS interpreta de forma predeterminada todos los datos numéricos como medidas. Por el comportamiento predeterminado, SAS nos tomará también como medidas la edad de una persona, el ID interno de una tabla (ID_EXPEDIENTE, ID_BENEFICIO), el año caratulación, etc. Por lo tanto una vez añadida la fuenta de datos al reporte, debemos seleccionar las categorías que fueron interpretadas como medidas y, elemento por elemmento, convertirlos a categoria: Figure 2.2: Medida2Categoria Una vez hecho esto para el ID_BENEFICIO y el NUMERO_DOCUMENTO sólamente nos quedará una única medida en la lista de elementos de datos, la frecuencia. La frecuencia es una medida que tendremos siempre disponible y nos servirá para contabilizar los registros de nuestro set de datos. En este caso, la frecuencia total de la tabla debería coincidir entonces con la cantidad de valores distintos de ID_BENEFICIO, dado que como comentamos anteriormente cada registro de la tabla representaba un beneficio. Para verifiar lo anterior podemos construir nuestra propia medida para contabilizar beneficios. 5.3 Elementos calculados 5.3.1 Uso de DISTINCT En la pantalla de edición del nuevo elemento calculado: 1. Seleccionamos la sección “Operadores” 2. Seleccionamos el apartado “Agregado (simple)” 3. Elegimos “DISTINCT” y arrastramos hacia el área de construcción del elemento calculado Figure 2.3: DISTINCT Luego hacemos click en la sección “Elementos de Datos”, seleccionamos el “ID_BENEFICIO” y lo llevamos como argumento a la función “DISTINCT”. El elemento calculado debe quedar como en la siguiente imagen: Figure 2.4: DISTINCT Una vez guardado, si vamos a la lista de elementos de datos, veremos que se nos agregó la medida “Total Beneficios”, como medida de agregación. Figure 2.5: DISTINCT Si quisieramos ahora tener un elemento calculado para contabilizar beneficiarios, deberiamos hacer lo mismo, pero en este caso usando el ID de cada persona, en este caso como no tenemos un ID de persona o beneficiario, debemos utiliza el número de documento. Para ser precisos deberíamos considerar como ID el tipo y numero de documento, lo cual nos invita a utilizar otra función básica que será de utilidad para crear elementos calculados concatenando distintas columnas. 5.3.2 Concatenar cadenas de caracteres Nuevo elemento calculado Seleccionamos “Operadores” Elegimos la función “Concatenate” del grupo de funciones de “Texto (simple)” Esta función acepta dos argumentos, que son las cadenas de caracteres a concatenar. Figure 2.6: DISTINCT En nuestro caso aunque podríamos concatenar directamente el tipo y número de documento, como preferimos un guión en el medio, vamos a usar dos funciones “Concatenate” anidades en el mismo elemento calculado: Figure 2.7: DISTINCT Nótese que fue necesario usar una función de conversión que nos permita incluir el Nro. de Documento que es numérico. La función “Format” la encontramos dentro del grupo de funciones de “Texto (simple)” Por último así como construimos “Total Beneficios”, podemos haciendo uso de “DISTINCT” construir un nuevo elemento calculado “Total Beneficiarios” aplicando la función “DISTINCT” sobre el elemento que creamos en el punto anterior “Tipo y Nro. de Documento” ##Gráfico “Valor Clave” Ahora veremos los distintos totales usando el grafico “Valor Clave” Vamos al panel de objetos y dentro del grupo “Gráficos” elegimos “Valor Clave”, Arrastramos el objeto al area de edición En roles de datos le asignamos como Medida, la Frecuencia. En el panel de opciones, bajamos hasta la configuración específica del gráfico “Valor clave” y elegimos el estilo “Infografía” Seguimos en el mismo panel de opciones y en la parte inferior, destildamos la opción “Usar valor abreviado”. Figure 2.8: DISTINCT Figure 2.9: DISTINCT Lo que vemos en este valor clave es la cantidad total de registros en la tabla. Ahora vamos a las opciones del gráfico, haciendo click en los “3 puntitos” que se encuentran en la esquina superior derecha del gráfico. Elegimos duplicar y cambiamos la medida, reemplazando la frecuencia por “Total Beneficios” Como vemos, la cantidad de beneficios coincide con la cantidad de registros de la tabla. Hacemos lo mismo y generemos otro gráfico de valor clave, tomando como medida en este caso el “Total Beneficiarios” Figure 2.10: DISTINCT ##Gráfico de Torta Haciendo click en el “+” a la derecha del título de la pagina “Pagina 1”, creamos una nueva página. En el panel de objetos, en la sección de gráficos, seleccionamos “Diagrama de tarta” Arrastramos al area de trabajo En el panel de “Roles de datos” elegimos la categoría “Plan” Vemos que por default nos toma como medida la frecuencia, la cambiamos por “Total Beneficios” Duplicamos el gráfico y seleccionamos como medida, “Total Beneficiarios” Figure 2.11: DISTINCT Borramos ahora el segundo gráfico. “Momento de jugar con las opciones que nos propone el panel de estilos del gráfico, buscando la mejor forma de mostrar la torta.” 5.4 Gráfico de barras En el panel de objetos, en la sección de gráficos, seleccionamos “Gráfico de barras” Arrastramos al area de trabajo, al lado del otro gráfico En el panel de “Roles de datos” elegimos la categoría “ESTADO_BENEFICIO” Modificamos Frecuencia por “Total Beneficios” 5.5 Controles de filtros En el panel de objetos, en la sección Controles, seleccionamos “Lista” Arrastramos al area de trabajo Asignamos en roles la categoría “USUARIO_ALTA_BENEFICIO” En el panel de objetos, en la sección Controles, seleccionamos “Barra deslizante” Arrastranis al area de trabajo En el panel de “Roles de datos” elegimos como medida/fecha, la “FECHA_ALTA_BENEFICIO_D” 5.6 Acciones, hacer interactuar gráficos y filtros entre sí En el panel de acciones, elegimos la opción “Acciones automáticas en todos los objetos” Probamos los filtros y la interacción entre los gráficos Figure 5.1: DISTINCT "],
["mapas.html", "Capítulo 6 Mapas", " Capítulo 6 Mapas &lt;&lt;Este capítulo esta en construcción, falta completar.&gt;&gt; El objetivo de este capítulo es explicar paso a paso como crear una visualización de datos sobre mapas geográficos. Para esto haremos uso de tablas que ya estan precargadas en SAS Viya, y que reunen la información de los polígonos. &lt;&gt; Nuevo reporte, opción “Explorar y visualizar datos” Agregamos la tabla CAS al reporte: Figure 2.1: Añadir fuente de datos Generamos el elemento calculado “SECCION_MANZANA” Figure 2.2: Añadir fuente de datos Generamos el elemento calculado, Elemento greográfico, “SECCION_MANZANA” Figure 2.3: Añadir fuente de datos Generamos el elemento calculado “SECCION_MANZANA_PARCELA” Figure 2.4: Añadir fuente de datos Generamos el elemento calculado, Elemento greográfico, “SECCION_MANZANA_PARCELA_GEO” Figure 2.5: Añadir fuente de datos Generamos la jerarquía con los elementos geográficos Figure 2.6: Añadir fuente de datos Seleccionamos el grafico “Mapa Geo” Asociamos la jerarquía creada como rol de datos del mapas Figure 2.7: Añadir fuente de datos Creamos otroa mapa y le asociamos el rol “ManzanaGEO” Figure 2.8: Añadir fuente de datos Generamos la interacción automática entre todos los objetos Figure 2.9: Añadir fuente de datos Figure 2.10: Añadir fuente de datos "]
]
